<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>My Wasm Project</title>
  </head>

  <body>
    <script type="module">
      // Importing WASM as a JS module requires us to call an init function provided by the default export.
      // This is planned to be changed in the future.
      import { default as wasm, setup_cost, ffi_cost, ffi_cost2, ffi_cost3, ffi_cost4 } from "./pkg/mimc_wasm.js";

      
      wasm().then((module) => {

          let task = {
            chunkFootprint: {
              bottomLeft:{
                x:208,
                y:144,
              },
              sideLength:16
            },
            planetHashKey:8,
            planetRarity:16384
          };
          



          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = setup_cost(task);
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("heatup.")
          console.log('\n\n')




          




          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = setup_cost(task);
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("Call to setup_cost " + avg + " milliseconds.")
          console.log('\n\n')





          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = ffi_cost();
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("Call to ffi_cost " + avg + " milliseconds.")
          console.log('\n\n')



          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = ffi_cost2(task);
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("Call to ffi_cost2 " + avg + " milliseconds.")
          console.log('\n\n')

          
          
          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = ffi_cost3();
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("Call to ffi_cost3 " + avg + " milliseconds.")
          console.log('\n\n')


          var times = [];
          for (let i = 0; i < 10000; i++) {
              var t0 = performance.now()
              var hash = ffi_cost4(task);
              var t1 = performance.now()
              var time = (t1 - t0);
              times.push(time);
          }
          var avg = times.reduce((accumulator, currentValue) => accumulator + currentValue) / times.length;
          console.log("Call to ffi_cost4 " + avg + " milliseconds.")
          console.log('\n\n')

          


      });
    </script>
  </body>
</html>
